// Generated by BUCKLESCRIPT VERSION 3.1.5, PLEASE EDIT WITH CARE
'use strict';

var Json = require("@glennsl/bs-json/src/Json.bs.js");
var Belt_List = require("bs-platform/lib/js/belt_List.js");
var Json_encode = require("@glennsl/bs-json/src/Json_encode.bs.js");
var Belt_MapString = require("bs-platform/lib/js/belt_MapString.js");
var Helpers$ReactTemplate = require("./Helpers.bs.js");
var CanonicalizeGraph$ReactTemplate = require("./CanonicalizeGraph.bs.js");

function encodePrimitiveValue(primitiveValue) {
  var tmp;
  switch (primitiveValue.tag | 0) {
    case 0 : 
        tmp = /* :: */[
          /* tuple */[
            "type",
            "integer"
          ],
          /* :: */[
            /* tuple */[
              "value",
              primitiveValue[0]
            ],
            /* [] */0
          ]
        ];
        break;
    case 1 : 
        tmp = /* :: */[
          /* tuple */[
            "type",
            "number"
          ],
          /* :: */[
            /* tuple */[
              "value",
              primitiveValue[0]
            ],
            /* [] */0
          ]
        ];
        break;
    case 2 : 
        tmp = /* :: */[
          /* tuple */[
            "type",
            "text"
          ],
          /* :: */[
            /* tuple */[
              "value",
              primitiveValue[0]
            ],
            /* [] */0
          ]
        ];
        break;
    
  }
  return Json_encode.object_(tmp);
}

function encodeConstant(primitiveValue) {
  return Json.stringify(Json_encode.object_(/* :: */[
                  /* tuple */[
                    "type",
                    "constant"
                  ],
                  /* :: */[
                    /* tuple */[
                      "value",
                      encodePrimitiveValue(primitiveValue)
                    ],
                    /* [] */0
                  ]
                ]));
}

function canonicalizeTypedFields(typedFields) {
  var nibOrdering = Belt_List.map(Helpers$ReactTemplate.sortBy(Belt_MapString.toList(typedFields), (function (prim) {
              return prim[1];
            })), (function (prim) {
          return prim[0];
        }));
  var canonical = Belt_List.map(nibOrdering, (function (nibID) {
          return Belt_MapString.getExn(typedFields, nibID);
        }));
  return /* tuple */[
          canonical,
          nibOrdering
        ];
}

function canonicalizeImplementation(implementation, dependencies) {
  switch (implementation.tag | 0) {
    case 0 : 
        return /* tuple */[
                encodeConstant(implementation[0]),
                /* [] */0,
                /* [] */0
              ];
    case 3 : 
        return CanonicalizeGraph$ReactTemplate.canonicalizeGraph(implementation[0], dependencies);
    default:
      return /* tuple */[
              "todo",
              /* [] */0,
              /* [] */0
            ];
  }
}

exports.encodePrimitiveValue = encodePrimitiveValue;
exports.encodeConstant = encodeConstant;
exports.canonicalizeTypedFields = canonicalizeTypedFields;
exports.canonicalizeImplementation = canonicalizeImplementation;
/* Json_encode Not a pure module */
